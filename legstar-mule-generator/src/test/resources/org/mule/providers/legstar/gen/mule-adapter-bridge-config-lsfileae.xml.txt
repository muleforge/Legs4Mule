<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mule-configuration PUBLIC "-//MuleSource //DTD mule-configuration XML V1.0//EN"
                                "http://mule.mulesource.org/dtds/mule-configuration.dtd">

<!--  This Mule configuration implements an adapter for a legacy function.
      It uses the bridge component as well as generated Legs4Mule transformers.
 -->
<mule-configuration id="mule-legstar-adapter-bridge-lsfileae-config" version="1.0">

    <description>Mule configuration file for lsfileae bridge Legs4Mule component</description>
    <mule-environment-properties enableMessageEvents="true"/>
    <transformers>
        <transformer name="ByteArrayToObject" className="org.mule.transformers.simple.ByteArrayToObject"/>
        <transformer name="HostByteArrayToDfhcommarea" className="org.mule.providers.legstar.test.lsfileae.HostByteArrayToDfhcommarea"/>
        <transformer name="DfhcommareaToHostByteArray" className="org.mule.providers.legstar.test.lsfileae.DfhcommareaToHostByteArray"/>
    </transformers>

    <model name="lsfileaeModel">

        <mule-descriptor name="lsfileaeBridgeUMO"
            implementation="org.mule.components.simple.BridgeComponent">
            <inbound-router>
                <endpoint address="tcp://localhost:3213"
                  transformers="ByteArrayToObject"
                  responseTransformers="HostByteArrayToDfhcommarea"
                  remoteSync="true"/>
            </inbound-router>
            <outbound-router>
                <router className="org.mule.routing.outbound.OutboundPassThroughRouter">
                    <!-- TODO Change to your host ip address and port. Must be a valid LegStar destination. -->
                    <endpoint address="legstar:http://mainframe:4081/CICS/CWBA/LSWEBBIN"
                              transformers="DfhcommareaToHostByteArray" >
                        <properties>
                            <property name="hostCharset" value="IBM01140"/>
                            <property name="hostTraceMode" value="true"/>
                            <property name="programPropFileName" value="lsfileae.properties"/>
                        </properties>
                    </endpoint>
                </router>
            </outbound-router>
        </mule-descriptor>

    </model>
</mule-configuration>